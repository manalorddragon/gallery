<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>ESP32-CAM Cloudinary Gallery</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { font-family: system-ui, Arial; max-width: 960px; margin: 2rem auto; padding: 0 1rem; }
    .flex { display:flex; flex-wrap:wrap; gap:12px; }
    .card { width:320px; text-align:center; }
    img { max-width:100%; height:auto; border-radius:6px; }
    .meta { font-size:0.9rem; color:#444; margin-top:6px; }
  </style>
</head>
<body>
  <h1>ESP32-CAM Gallery (Cloudinary)</h1>
  <p>Images uploaded from the camera.</p>
  <div id="gallery" class="flex">Loading...</div>

  <script>
    async function load() {
      try {
        const res = await fetch('/images.json'); // images.json stored in repo
        const list = await res.json();
        const g = document.getElementById('gallery');
        g.innerHTML = '';
        list.sort((a,b)=> (b.created_at || 0) - (a.created_at || 0));
        for (const item of list) {
          const d = document.createElement('div'); d.className = 'card';
          const img = document.createElement('img');
          img.src = item.secure_url || item.url;
          d.appendChild(img);
          const p = document.createElement('div'); p.className='meta';
          p.textContent = (item.public_id || '').split('/').pop() + ' â€” ' + (new Date(item.created_at||item.uploaded_at||0)).toLocaleString();
          d.appendChild(p);
          g.appendChild(d);
        }
        if (list.length===0) g.innerHTML = '<p>No images yet</p>';
      } catch (e) {
        document.getElementById('gallery').innerHTML = '<p>Failed to load images.json</p>';
        console.error(e);
      }
    }
    load();
  </script>
</body>
</html>
